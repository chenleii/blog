"use strict";(self.webpackChunkblog_ui=self.webpackChunkblog_ui||[]).push([[738],{9229:function(e,t,n){var r=n(97857),i=n.n(r),s=(n(67294),n(95925)),l=n(34768),a=n(85893);t.Z=function(e){var t=e.content,n=e.isHtml,r=void 0===n||n;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.D,{rehypePlugins:r?[l.Z]:[],components:{img:function(e){return(0,a.jsx)("img",i()(i()({},e),{},{style:{maxWidth:"100%"}}))}},children:t||""})})}},62148:function(e,t,n){n.r(t);var r=n(15009),i=n.n(r),s=n(97857),l=n.n(s),a=n(99289),o=n.n(a),c=n(5574),u=n.n(c),d=n(99913),m=n(65429),p=n(10844),h=n(28058),f=n(38545),x=n(20046),v=n(49693),g=n(12461),j=n(59652),Z=n(26713),y=n(84485),M=n(27049),A=n(55241),k=n(81579),b=n(69677),C=n(71577),w=n(31990),D=n(95507),I=n(84908),N=n(44057),Y=n(71511),P=n(67294),S=n(57328),B=n(9832),F=n(30381),T=n.n(F),H=n(14104),L=n(9229),z=n(20640),_=n.n(z),R=n(85893);t.default=function(){var e,t,n,r=((0,S.useModel)("@@initialState").initialState||{}).loggedInAccount,s=(0,P.useState)(!1),a=u()(s,2),c=a[0],F=a[1],z=(0,S.useParams)(),q=(0,P.useState)({}),E=u()(q,2),J=E[0],U=E[1],W=(0,S.useIntl)(),G=(0,S.useAccess)(),K=function(){var e=o()(i()().mark((function e(t){var n,r;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.Z.articleApi.like({articleId:t.id});case 2:n=e.sent,r=l()(l()({},J),{},{isLiked:!J.isLiked,likedNumber:n}),U(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=o()(i()().mark((function e(t,n){var r,s;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.Z.articleApi.report({articleId:t.id,remark:n.remark});case 2:r=e.sent,s=l()(l()({},J),{},{isReported:!0,reportedNumber:r}),U(s);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Q=function(){var e=o()(i()().mark((function e(t,n){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.Z.articleApi.comment({articleId:t.id,content:n.commentContent});case 2:return e.next=4,$();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),V=function(){var e=o()(i()().mark((function e(t,n,r,s){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.Z.articleApi.replySubComment({articleId:null==t?void 0:t.id,commentId:null==n?void 0:n.id,replyCommentId:r.id,content:s.commentContent});case 2:return e.next=4,$();case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),X=function(){var e=o()(i()().mark((function e(){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_()(window.location.href),g.ZP.success(W.formatMessage({id:"pages.ArticleDetails.share.message"}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=o()(i()().mark((function e(){var t,n,r;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=z.articleId,e.next=4,B.Z.articleApi.query({articleId:n});case 4:(r=e.sent).comments=null==r||null===(t=r.comments)||void 0===t?void 0:t.map((function(e){var t;return null==e||null===(t=e.subComments)||void 0===t||t.sort((function(e,t){return((null==t?void 0:t.commentedAt)||0)-((null==e?void 0:e.commentedAt)||0)})),e})).sort((function(e,t){return((null==t?void 0:t.commentedAt)||0)-((null==e?void 0:e.commentedAt)||0)})),U(l()({},r));case 7:return e.prev=7,F(!1),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[0,,7,10]])})));return function(){return e.apply(this,arguments)}}();return(0,P.useEffect)((function(){F(!0),$()}),[z]),(0,R.jsxs)(v._zJ,{header:{title:""},loading:c,children:[(0,R.jsxs)(j.Z,{bordered:!1,style:{marginBottom:24},loading:c,extra:G.canArticleUpdate(J)?(0,R.jsx)("a",{onClick:function(){return S.history.push("/article/".concat(null==J?void 0:J.id,"/editor"))},children:W.formatMessage({id:"pages.ArticleDetails.update",defaultMessage:"编辑"})}):void 0,children:[(0,R.jsxs)(Z.Z,{direction:"vertical",align:"center",style:{width:"100%"},children:[(0,R.jsx)(Y.Z,{src:null==J||null===(e=J.account)||void 0===e?void 0:e.avatar,alt:"",size:128}),(0,R.jsx)(y.Z.Title,{level:3,children:null==J||null===(t=J.account)||void 0===t?void 0:t.name}),(0,R.jsx)(y.Z.Paragraph,{children:null==J||null===(n=J.account)||void 0===n?void 0:n.introduction})]}),(0,R.jsx)(y.Z.Title,{ellipsis:{rows:1},level:1,children:(0,R.jsx)(L.Z,{content:null==J?void 0:J.title})}),(0,R.jsx)(y.Z.Paragraph,{children:(0,R.jsx)(L.Z,{content:(null==J?void 0:J.customContent)||""})}),(0,R.jsxs)(Z.Z,{split:(0,R.jsx)(M.Z,{type:"vertical"}),children:[(0,R.jsxs)(Z.Z,{onClick:function(){return K(J)},children:[null!=J&&J.isLiked?(0,R.jsx)(d.Z,{}):(0,R.jsx)(m.Z,{}),(0,R.jsx)("span",{children:null==J?void 0:J.likedNumber})]}),(0,R.jsxs)(Z.Z,{children:[(0,R.jsx)(A.Z,{title:W.formatMessage({id:"pages.ArticleDetails.report.title",defaultMessage:"确认举报吗？"}),content:(0,R.jsxs)(k.Z,{onFinish:function(e){return O(J,e)},layout:"vertical",children:[(0,R.jsx)(k.Z.Item,{label:W.formatMessage({id:"pages.ArticleDetails.report.remark",defaultMessage:"举报原因"}),name:"remark",children:(0,R.jsx)(b.Z,{placeholder:W.formatMessage({id:"pages.ArticleDetails.report.remark",defaultMessage:"举报原因"})})}),(0,R.jsx)(k.Z.Item,{children:(0,R.jsx)(C.Z,{type:"primary",htmlType:"submit",children:W.formatMessage({id:"pages.ArticleDetails.report.submitButton",defaultMessage:"举报"})})})]}),trigger:"click",children:null!=J&&J.isReported?(0,R.jsx)(p.Z,{}):(0,R.jsx)(h.Z,{})}),null==J?void 0:J.reportedNumber]}),(0,R.jsxs)(Z.Z,{children:[(0,R.jsx)(f.Z,{}),null!=J&&J.comments?null==J?void 0:J.comments.length:0]}),(0,R.jsxs)(Z.Z,{onClick:function(){return X()},children:[(0,R.jsx)(x.Z,{}),W.formatMessage({id:"pages.ArticleDetails.share.title",defaultMessage:"分享"})]})]})]}),(0,R.jsxs)(j.Z,{title:W.formatMessage({id:"pages.ArticleDetails.comment.title",defaultMessage:"评论"}),bordered:!1,style:{marginBottom:24},loading:c,children:[(0,R.jsx)(w.Z,{avatar:(0,R.jsx)(Y.Z,{src:null==r?void 0:r.avatar,alt:null==r?void 0:r.name}),content:(0,R.jsxs)(k.Z,{onFinish:function(e){return Q(J,e)},layout:"vertical",children:[(0,R.jsx)(k.Z.Item,{name:"commentContent",children:(0,R.jsx)(H.Z,{rows:4})}),(0,R.jsx)(k.Z.Item,{children:(0,R.jsx)(C.Z,{htmlType:"submit",type:"primary",children:W.formatMessage({id:"pages.ArticleDetails.comment.submitButton",defaultMessage:"提交评论"})})})]})}),(0,R.jsx)(D.ZP,{className:"comment-list",itemLayout:"horizontal",dataSource:null==J?void 0:J.comments,renderItem:function(e){var t,n,r,i;return(0,R.jsx)("li",{children:(0,R.jsx)(w.Z,{actions:[(0,R.jsx)(A.Z,{title:W.formatMessage({id:"pages.ArticleDetails.replyComment.title",defaultMessage:"回复"}),content:(0,R.jsxs)(k.Z,{onFinish:function(t){return V(J,e,{},t)},layout:"vertical",children:[(0,R.jsx)(k.Z.Item,{label:W.formatMessage({id:"pages.ArticleDetails.replyComment.content",defaultMessage:"回复内容"}),name:"commentContent",children:(0,R.jsx)(H.Z,{rows:4})}),(0,R.jsx)(k.Z.Item,{children:(0,R.jsx)(C.Z,{type:"primary",htmlType:"submit",children:W.formatMessage({id:"pages.ArticleDetails.replyComment.submitButton",defaultMessage:"回复"})})})]}),trigger:"click",children:(0,R.jsx)("span",{children:W.formatMessage({id:"pages.ArticleDetails.replyComment.title",defaultMessage:"回复"})},"comment-nested-reply-to")})],author:(0,R.jsx)("a",{children:null==e||null===(t=e.account)||void 0===t?void 0:t.name}),avatar:(0,R.jsx)(Y.Z,{src:null==e||null===(n=e.account)||void 0===n?void 0:n.avatar,alt:""}),datetime:(0,R.jsx)(I.Z,{title:T()().format("YYYY-MM-DD HH:mm:ss"),children:(0,R.jsx)("span",{children:T()(null==e?void 0:e.commentedAt).fromNow()})}),content:(0,R.jsx)("p",{children:null==e?void 0:e.content}),children:((null==e||null===(r=e.subComments)||void 0===r?void 0:r.length)||0)>0?(0,R.jsx)(D.ZP,{className:"comment-list",header:"".concat(null==e||null===(i=e.subComments)||void 0===i?void 0:i.length," replies"),itemLayout:"horizontal",dataSource:null==e?void 0:e.subComments,renderItem:function(t){var n,r;return(0,R.jsx)("li",{children:(0,R.jsx)(w.Z,{actions:[(0,R.jsx)(A.Z,{title:W.formatMessage({id:"pages.ArticleDetails.replyComment.title",defaultMessage:"回复"}),content:(0,R.jsxs)(k.Z,{onFinish:function(n){return V(J,e,t,n)},layout:"vertical",children:[(0,R.jsx)(k.Z.Item,{label:W.formatMessage({id:"pages.ArticleDetails.replyComment.content",defaultMessage:"回复内容"}),name:"commentContent",children:(0,R.jsx)(H.Z,{rows:4})}),(0,R.jsx)(k.Z.Item,{children:(0,R.jsx)(C.Z,{type:"primary",htmlType:"submit",children:W.formatMessage({id:"pages.ArticleDetails.replyComment.submitButton",defaultMessage:"回复"})})})]}),trigger:"click",children:(0,R.jsx)("span",{children:W.formatMessage({id:"pages.ArticleDetails.replyComment.title",defaultMessage:"回复"})},"comment-nested-reply-to")})],author:(0,R.jsx)("a",{children:null==t||null===(n=t.account)||void 0===n?void 0:n.name}),avatar:(0,R.jsx)(Y.Z,{src:null==t||null===(r=t.account)||void 0===r?void 0:r.avatar,alt:""}),datetime:(0,R.jsx)(I.Z,{title:T()().format("YYYY-MM-DD HH:mm:ss"),children:(0,R.jsx)("span",{children:T()(null==t?void 0:t.commentedAt).fromNow()})}),content:(0,R.jsx)("p",{children:null==t?void 0:t.content})})})}}):(0,R.jsx)(R.Fragment,{})})})}})]}),(0,R.jsx)(N.Z,{})]})}}}]);