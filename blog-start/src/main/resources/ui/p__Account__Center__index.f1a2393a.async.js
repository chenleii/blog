"use strict";(self.webpackChunkblog_ui=self.webpackChunkblog_ui||[]).push([[931],{55843:function(e,t,n){var r=n(861),i=n.n(r),a=n(17061),l=n.n(a),s=n(42122),u=n.n(s),c=n(17156),o=n.n(c),d=n(27424),p=n.n(d),v=n(99913),f=n(65429),h=n(10844),x=n(28058),g=n(38545),m=n(20046),Z=n(2453),j=n(21687),k=n(96074),w=n(46821),y=n(26713),I=n(74627),M=n(80442),b=n(69677),S=n(71577),A=n(71819),z=n(71230),C=n(15746),L=n(71511),P=n(67294),D=n(51094),T=n(58533),N=n(72241),V=n(60419),B=n(20640),E=n.n(B),Q=n(85893);t.Z=function(e){var t,n,r=e.forceUpdate,a=e.pageQuery,s=(0,D.useIntl)(),c=(0,P.useState)(!1),d=p()(c,2),B=(d[0],d[1]),R=(0,P.useState)(0),_=p()(R,2),F=_[0],K=_[1],U=(0,P.useState)({}),q=p()(U,2),H=q[0],G=q[1],J=function(){var e=o()(l()().mark((function e(t){var n,r;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.Z.articleApi.like({articleId:t.id});case 2:r=e.sent,G(u()(u()({},H),{},{list:null==H||null===(n=H.list)||void 0===n?void 0:n.map((function(e){return(null==e?void 0:e.id)===t.id&&(e.isLiked=!t.isLiked,e.likedNumber=r),e}))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=o()(l()().mark((function e(t,n){var r,i;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.Z.articleApi.report({articleId:t.id,remark:n.remark});case 2:i=e.sent,G(u()(u()({},H),{},{list:null==H||null===(r=H.list)||void 0===r?void 0:r.map((function(e){return(null==e?void 0:e.id)===t.id&&(e.isReported=!0,e.reportedNumber=i),e}))}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=o()(l()().mark((function e(){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E()(window.location.href),Z.ZP.success(s.formatMessage({id:"pages.ArticleDetails.share.message"}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=o()(l()().mark((function e(){var t,n,r,s=arguments;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]&&s[0],B(!0),e.prev=2,n=F+1,t&&(n=1,H.list=[]),K(n),e.next=8,a(n);case 8:return r=e.sent,e.next=11,G({pageIndex:r.pageIndex,pageSize:r.pageSize,list:[].concat(i()(H.list||[]),i()(r.list||[])),total:r.total,lastValues:r.lastValues});case 11:return e.prev=11,B(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[2,,11,14]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=o()(l()().mark((function e(){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X(!0);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,P.useEffect)((function(){Y()}),[r]),(0,Q.jsx)(T.Z,{dataLength:(null==H||null===(t=H.list)||void 0===t?void 0:t.length)||0,next:X,hasMore:((null==H||null===(n=H.list)||void 0===n?void 0:n.length)||0)<((null==H?void 0:H.total)||0),pullDownToRefresh:!0,refreshFunction:Y,loader:(0,Q.jsx)(j.Z,{avatar:!0,paragraph:{rows:1},active:!0}),endMessage:(0,Q.jsx)(k.Z,{plain:!0,children:s.formatMessage({id:"component.endMessage"})}),children:(0,Q.jsx)(w.ZP,{itemLayout:"vertical",size:"default",dataSource:null==H?void 0:H.list,renderItem:function(e){var t,n,r;return(0,Q.jsxs)(w.ZP.Item,{actions:[(0,Q.jsxs)(y.Z,{onClick:function(){return J(e)},children:[null!=e&&e.isLiked?(0,Q.jsx)(v.Z,{}):(0,Q.jsx)(f.Z,{}),null==e?void 0:e.likedNumber]}),(0,Q.jsxs)(y.Z,{children:[(0,Q.jsx)(I.Z,{title:s.formatMessage({id:"pages.ArticleDetails.report.title",defaultMessage:"确认举报吗？"}),content:(0,Q.jsxs)(M.Z,{onFinish:function(t){return O(e,t)},layout:"vertical",children:[(0,Q.jsx)(M.Z.Item,{label:s.formatMessage({id:"pages.ArticleDetails.report.remark",defaultMessage:"举报原因"}),name:"remark",children:(0,Q.jsx)(b.Z,{placeholder:s.formatMessage({id:"pages.ArticleDetails.report.remark",defaultMessage:"举报原因"})})}),(0,Q.jsx)(M.Z.Item,{children:(0,Q.jsx)(S.ZP,{type:"primary",htmlType:"submit",children:s.formatMessage({id:"pages.ArticleDetails.report.submitButton",defaultMessage:"举报"})})})]}),trigger:"click",children:null!=e&&e.isReported?(0,Q.jsx)(h.Z,{}):(0,Q.jsx)(x.Z,{})}),null==e?void 0:e.reportedNumber]}),(0,Q.jsxs)(y.Z,{children:[(0,Q.jsx)(g.Z,{}),null!=e&&e.comments?null==e?void 0:e.comments.length:0]}),(0,Q.jsxs)(y.Z,{onClick:function(){return W()},children:[(0,Q.jsx)(m.Z,{}),s.formatMessage({id:"pages.ArticleDetails.share.title",defaultMessage:"分享"})]})],extra:(null!=e&&e.cover,null),children:[(0,Q.jsx)(w.ZP.Item.Meta,{avatar:(0,Q.jsx)(L.Z,{src:null==e||null===(t=e.account)||void 0===t?void 0:t.avatar,size:"large"}),title:null==e||null===(n=e.account)||void 0===n?void 0:n.name,description:null==e||null===(r=e.account)||void 0===r?void 0:r.introduction,onClick:function(){var t;return D.history.push("/account/".concat(null==e||null===(t=e.account)||void 0===t?void 0:t.id))}}),(0,Q.jsxs)(A.Z,{onClick:function(){return D.history.push("/article/".concat(e.id))},children:[(0,Q.jsx)(A.Z.Title,{ellipsis:{rows:1,tooltip:null==e?void 0:e.title},level:1,style:{marginTop:0},children:null==e?void 0:e.title}),(0,Q.jsxs)(z.Z,{children:[(0,Q.jsx)(C.Z,{lg:null!=e&&e.cover?16:24,xs:24,children:(0,Q.jsx)(A.Z.Paragraph,{ellipsis:{rows:5},style:{maxHeight:"200px"},children:(0,Q.jsx)(V.Z,{content:(null==e?void 0:e.customContent)||""})})}),(0,Q.jsx)(C.Z,{lg:null!=e&&e.cover?8:0,xs:0,children:(0,Q.jsx)("img",{width:"100%",style:{paddingLeft:16},alt:"cover",src:null==e?void 0:e.cover,onError:function(){var t;return G(u()({list:null==H||null===(t=H.list)||void 0===t?void 0:t.map((function(t){return(null==t?void 0:t.id)===(null==e?void 0:e.id)&&(t.cover=void 0),t}))},H))}})})]})]})]},null==e?void 0:e.id)}})})}},40905:function(e,t,n){n.r(t);var r=n(17061),i=n.n(r),a=n(42122),l=n.n(a),s=n(17156),u=n.n(s),c=n(27424),o=n.n(c),d=n(87659),p=n(4393),v=n(26713),f=n(71819),h=n(69677),x=n(93410),g=n(71511),m=n(67294),Z=n(51094),j=n(72241),k=n(55843),w=n(85893);t.default=function(){var e=((0,Z.useModel)("@@initialState").initialState||{}).loggedInAccount,t=(0,m.useState)(!1),n=o()(t,2),r=n[0],a=n[1],s=(0,m.useState)(""),c=o()(s,2),y=c[0],I=c[1],M=(0,Z.useParams)(),b=(0,m.useState)({}),S=o()(b,2),A=S[0],z=S[1],C=(0,m.useState)({pageIndex:1,pageSize:10,accountId:(null==M?void 0:M.accountId)||(null==e?void 0:e.id)+"",searchKeyword:y}),L=o()(C,2),P=L[0],D=L[1],T=(0,Z.useIntl)(),N=(0,Z.useLocation)().pathname.includes("/center"),V=function(){var t=u()(i()().mark((function t(){var n;return i()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a(!0),t.prev=1,!N){t.next=5;break}return z(l()({},e)),t.abrupt("return");case 5:return t.next=7,j.Z.accountApi.query({accountId:M.accountId});case 7:n=t.sent,z(n);case 9:return t.prev=9,a(!1),t.finish(9);case 12:case"end":return t.stop()}}),t,null,[[1,,9,12]])})));return function(){return t.apply(this,arguments)}}(),B=function(){var e=u()(i()().mark((function e(t){var n;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Z.articleApi.pageQuery(l()(l()({},P),{},{searchKeyword:y,pageIndex:t}));case 2:return n=e.sent,P.pageIndex=((null==P?void 0:P.pageIndex)||0)+1,P.lastValues=null==n?void 0:n.lastValues,D(P),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,m.useEffect)((function(){V()}),[M]),(0,w.jsxs)(d._z,{header:{title:""},children:[(0,w.jsx)(p.Z,{bordered:!1,style:{marginBottom:24},loading:r,title:"",children:(0,w.jsxs)(v.Z,{direction:"vertical",align:"center",style:{width:"100%"},children:[(0,w.jsx)(g.Z,{src:null==A?void 0:A.avatar,alt:"",size:128}),(0,w.jsx)(f.Z.Title,{level:3,children:null==A?void 0:A.name}),(0,w.jsx)(f.Z.Paragraph,{children:null==A?void 0:A.introduction})]})}),(0,w.jsx)(p.Z,{title:T.formatMessage({id:"pages.account.center.articleList.title",defaultMessage:"文章列表"}),extra:(0,w.jsx)(h.Z.Search,{size:"middle",allowClear:!0,onSearch:function(){var e=u()(i()().mark((function e(t,n){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I(t));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),children:(0,w.jsx)(k.Z,{pageQuery:B,forceUpdate:y})}),(0,w.jsx)(x.Z.BackTop,{})]})}},15746:function(e,t,n){var r=n(21584);t.Z=r.Z},71230:function(e,t,n){var r=n(92820);t.Z=r.Z}}]);